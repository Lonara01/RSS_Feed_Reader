document.addEventListener("DOMContentLoaded",function(){const loadFeedBtn=document.getElementById("load-feed");const rssUrlInput=document.getElementById("rss-url");const newsContainer=document.getElementById("news-container");loadFeed(rssUrlInput.value);loadFeedBtn.addEventListener("click",function(){const url=rssUrlInput.value.trim();if(url){loadFeed(url)}else{alert("Please enter a valid RSS feed URL")}});function loadFeed(feedUrl){newsContainer.innerHTML='<div class="loading">Loading news feed...</div>';fetch(`http://localhost:3001/api/rss?url=${encodeURIComponent(feedUrl)}`).then(response=>{if(!response.ok)throw new Error("Network response was not ok");return response.text()}).then(xmlString=>{const items=parseRSS(xmlString);displayNews(items)}).catch(error=>{console.error("Error fetching RSS feed:",error);newsContainer.innerHTML=`<div class="loading">Error loading feed: ${error.message}</div>`})}function parseRSS(xmlString){const parser=new DOMParser;const xmlDoc=parser.parseFromString(xmlString,"text/xml");console.log("Parsed XML Document:",xmlDoc);var items=xmlDoc.querySelectorAll("item");if(items.length===0){items=xmlDoc.querySelectorAll("entry")}const newsItems=[];items.forEach((item,index)=>{if(index>=10)return;console.log("Parsing item:",item);const title=item.querySelector("title")?.textContent||"No title";const description=item.querySelector("description")?.textContent||"No description";var link=item.querySelector("link")?.textContent||"#";if(link==="#"){link=item.querySelector("link")?.getAttribute("href")||"#"}let imageUrl="";const enclosure=item.querySelector("enclosure");if(enclosure&&enclosure.getAttribute("type")?.startsWith("image/")){imageUrl=enclosure.getAttribute("url")}else{const imgMatch=description.match(/<img[^>]+src="([^">]+)"/);if(imgMatch){imageUrl=imgMatch[1]}}newsItems.push({title:title,description:description.replace(/<[^>]*>?/gm,""),link:link,imageUrl:imageUrl})});return newsItems}function displayNews(items){console.log("Displaying news items:",items);if(items.length===0){newsContainer.innerHTML='<div class="loading">No news items found in the feed</div>';return}newsContainer.innerHTML="";items.forEach(item=>{const card=document.createElement("article");card.className="news-card";console.log("News Item:",item);const image=item.imageUrl?`<img src="${item.imageUrl}" alt="${item.title}" class="news-image" onerror="this.src='https://via.placeholder.com/300x180?text=No+Image'">`:`<div class="news-image" style="background: #eee; display: flex; align-items: center; justify-content: center; color: #999;">No Image</div>`;card.innerHTML=`\n                ${image}\n                <div class="news-content">\n                    <h3 class="news-title">${item.title}</h3>\n                    <p class="news-description">${item.description.substring(0,150)}...</p>\n                    <a href="${item.link}" class="news-link" target="_blank" rel="noopener noreferrer">Read more</a>\n                </div>\n            `;newsContainer.appendChild(card)})}});